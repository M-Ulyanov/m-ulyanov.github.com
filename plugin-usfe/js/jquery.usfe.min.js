/*

 USFE (User Style Form Elements) — jQuery plugin
 Version: 2.0.1
 Author: M.Ulyanov (web.ulyanov@gmail.com)
 Site: http://web-ulyanov.ru
 Source && Doc: https://github.com/M-Ulyanov/Plugin-USFE/
 Example: http://example.web-ulyanov.ru/frontend/usfe/demo/index.html

 */

 (function(e){e.fn.usfe=function(t){var n={f_defaultFileName:"Файл не выбран",f_defaultFileNameDel:"Файл не выбран",f_FileNameLength:30,f_defaultButtonName:"Выбрать",f_editButtonName:"Изменить",f_charDelete:"&#215;",f_bgDelete:"#f48475",n_maxVal:Infinity,n_editBg:true,n_iconPlus:"+",n_iconMinus:"-",t_animateEffect:true,t_animateSpeed:400,t_editW:12,t_editH:3,t_color:"#FFF",t_backgroundcolor:"#727272",te_animateEffect:true,te_animateSpeed:400,te_color:"#FFF",te_backgroundcolor:"#727272",s_height:false,cal_animateSpeed:0,cal_animateSwitch:false,cal_animateSwitchSpeed:300,se_animateEffect:true,se_animateSpeed:400,se_animateToogleSpeed:200,se_color:"#727272",se_backgroundcolor:"#f7f7f7"};t=e.extend(n,t);var r;var i={init:function(){r=e(this).data("tooltip");e(this).data("tooltip",{target:e(this)})},typeFile:function(t){function a(){var t=e(this).parent().find('input[type="file"]');e(t).prop("value","");e(this).parent().find(s).removeClass("select-file").text(n.f_defaultFileNameDel);e(this).parent().find(s).animate({opacity:1},400);e(this).css({display:"none"})}var r=e('<div class="file-wrap"></div>'),i=e('<button type="button" class="file-button"></button>'),s=e('<div class="file-name"></div>'),o=e('<span class="file-del">'+n.f_charDelete+"</a>");if(e(t).parents(".file-wrap").length<1){e(t).wrap(r);e(t).after(i,s)}e(t).parents(".file-wrap").find(".file-button").text(n.f_defaultButtonName);e(t).parents(".file-wrap").find(".file-name").text(n.f_defaultFileName);t=e(t);var u=e(t).attr("disabled");if(u){e(t).parents(".file-wrap").addClass("file-disabled")}e(i).on("click",function(){t.click();var u=window.File?true:false;e(t).on("change",function(){var a;if(u&&t[0].files[0]){a=t[0].files[0].name}else{a=t.val().split("\\");a=a[a.length-1]}if(!a.length){return}if(a.length>n.f_FileNameLength){var f=a;e(t).parent(r).attr("title",f);a=a.substring(0,n.f_FileNameLength);a=a+"..."}s.addClass("select-file").text(a);i.text(n.f_editButtonName);e(t).parent().append(o);e(o).css({display:"block",opacity:1})}).change()});e(o).on("click",function(){if(e(this).parents(".file-wrap").hasClass("file-disabled"))return false;var i=this;var o=e(t).parents(".file-wrap").css("backgroundColor");e(t).parent(r).removeAttr("title");e(this).parent().stop(true,true).animate({backgroundColor:n.f_bgDelete},400).stop(true,true).animate({backgroundColor:o},400);e(this).parent().find(s).animate({opacity:0});e(this).parent().find(i).animate({opacity:0});setTimeout(function(){a.call(e(i))},600)});},typeNumber:function(t){function o(t,r){if(isNaN(r)){r=1}if(r>n.n_maxVal)return false;e(t).parent().find('input[type="usfe-number"]').val(r);e(t).parent().find('input[type="usfe-number"]').attr("value",r)}var r=e('<div class="number-wrap"></div>'),i=e('<button type="button" value="-" class="number-plus"></button>'),s=e('<button type="button" value="-" class="number-minus"></button>');if(e(t).parents(".number-wrap").length<1){e(t).wrap(r);e(t).before(s).after(i);e(t).next(".number-plus").on("click",function(){var t=e(this).parent().find('input[type="usfe-number"]');var r=e(t).val();r++;if(n.n_editBg){e(t).stop(true,true).animate({backgroundColor:"#9bcb1e"},400).stop(true,true).animate({backgroundColor:"#FFF"},400)}o(this,r)});e(t).prev(".number-minus").on("click",function(){var t=e(this).parent().find('input[type="usfe-number"]');var r=e(t).val();r--;if(!r)r=1;if(n.n_editBg){e(t).stop(true,true).animate({backgroundColor:"#ea6856"},400).stop(true,true).animate({backgroundColor:"#FFF"},400)}o(this,r)})}e(t).parents(".number-wrap").find(".number-plus").text(n.n_iconPlus);e(t).parents(".number-wrap").find(".number-minus").text(n.n_iconMinus);e('input[type="usfe-number"]').on("keypress input change",function(t){if(t.charCode<48||t.charCode>57)return false;var n=e(this).parent().find('input[type="usfe-number"]').val();o(this,n)});},typeText:function(t){var r=e(t).attr("disabled");if(r){e(t).addClass("disabled-input")}if(n.t_animateEffect){var i=e('<div class="text-wrap">'),s=e(t).css("backgroundColor"),o=e(t).css("color"),u=e(t).height(),a=e(t).width(),f=e(t).innerHeight();if(e(t).parents(".text-wrap").length<1){e(t).wrap(i)}e(".text-wrap").css({position:"relative",height:f});e(t).focus(function(){e(this).animate({width:a+n.t_editW,height:u+n.t_editH,backgroundColor:n.t_backgroundcolor,color:n.t_color},n.t_animateSpeed)});e(t).focusout(function(){e(this).animate({width:a,height:u,backgroundColor:s,color:o},n.t_animateSpeed)})}},typeButton:function(t){e(t).addClass("butsub-element")},typeTextarea:function(t){if(n.te_animateEffect){textareaDefaultBg=e(t).css("backgroundColor"),textareaDefaultColor=e(t).css("color"),e(t).focus(function(){e(this).animate({backgroundColor:n.te_backgroundcolor,color:n.te_color},n.te_animateSpeed)});e(t).focusout(function(){e(this).animate({backgroundColor:textareaDefaultBg,color:textareaDefaultColor},n.te_animateSpeed)})}},typeRadio:function(t){if(e(t).parents(".radio-wrap").length<1){var n=e('<div class="radio-wrap">'),r=e('<span class="custom-radio"></span>'),i=e(t).attr("id"),s=e(t).attr("name"),o=e(t).next("label"),u=e(t).parent("label");if(e(t).parent("label").length){e(u).wrap(n);e(t).before(r)}else{e(t).wrap(n);e(t).before(r,o)}e(t).addClass("hidden-radio");e(r).attr({"data-radio":i,"data-radiogroup":s});if(o.length>0){var a=e("label[for='"+i+"']").text();var f=e(t).attr("value");if(!f){e(t).val(a)}}var l=e(t).attr("checked");var c=e(t).attr("disabled");if(l){var h=e(t).attr("name");e("span[data-radiogroup='"+h+"']").removeClass("active-radio");e(t).parents(".radio-wrap").find("span").addClass("active-radio");e(t).attr("checked",true)}if(c){e(t).parents(".radio-wrap").find("span").addClass("disable-radio")}e(r).on("click",function(){if(!e(this).hasClass("disable-radio")){var t=e(this).attr("data-radiogroup");e("span[data-radiogroup='"+t+"']").removeClass("active-radio");e(this).addClass("active-radio");var n=e(this).attr("data-radio");var r=e("input[id='"+n+"']").attr("name");e("input[name='"+r+"']").removeAttr("checked");e("input[id='"+n+"']").attr("checked",true);e("input[id='"+n+"']").click();if(typeof n==="undefined"){e(this).parents(".radio-wrap").find("input").click()}}});e(o).on("click",function(){r.click()});e(u).on("click",function(){if(!e(this).find("span").hasClass("disable-radio")){var t=e(this).find(".custom-radio");var n=e(t).attr("data-radiogroup");e("span[data-radiogroup='"+n+"']").removeClass("active-radio");e(t).addClass("active-radio")}})}},typeCheckbox:function(t){var n=e('<span class="custom-checkbox"></span>'),r=e('<div class="checkbox-wrap">'),i=e(t).next("label"),s=e(t).parent("label");if(e(t).parents(".checkbox-wrap").length<1){if(e(t).parent("label").length){e(s).wrap(r);e(t).before(n)}else{e(t).wrap(r);e(t).before(n).after(i)}e(t).css({opacity:0,position:"absolute",left:"-9999px"})}else{e(t).prev("span").remove();e(t).before(n)}if(i.length>0){var o=e(t).parent("div").find("label").text();var u=e(t).attr("value");if(!u){e(t).val(o)}}var a=e(t).attr("checked");if(a){e(t).prev("span").addClass("active-checkbox")}var f=e(t).attr("disabled");if(f){e(t).prev("span").addClass("disabled-checkbox")}e(n).on("click",function(){e(this).parent(".checkbox-wrap").find('input[type="checkbox"]').click()});e(t).on("click",function(){var t=e(this).parents(".checkbox-wrap");if(e(t).find("input").is(":checked")){e(t).find(n).addClass("active-checkbox");e(this).attr("checked",true)}else{e(t).find(n).removeClass("active-checkbox");e(this).removeAttr("checked")}})},typeSelect:function(t){var r=e('<div class="select-wrap">'),s=e('<div class="select-this">'),o=e('<div class="select-this-text">'),u=e('<div class="select-this-trigger">'),a=e('<div class="select-this-trigger-arrow"></div>'),f=e('<div class="select-dropdown">'),l=e("<ul>");if(e(t).parents(".select-wrap").length<1){e(t).before(r);e(s).append(o,e(u).append(a));e(r).append(s,f,t)}if(e(t).attr("disabled"))e(s).addClass("select-disabled");var c=false;var h=0;e(t).children("option, optgroup").each(function(){if(this.nodeName.toLowerCase()=="optgroup"){var t=e(this).attr("class");var n="optgroup";var r="option";e(l).append('<li class="'+n+" "+t+'">'+e(this).attr("label")+"</li>");e(this).find("option").each(function(){var n="element-"+h++;e(this).attr("data-opt",n);var i=e(this).text();e(l).append('<li data-li="'+n+'" class="'+r+" "+t+'">'+i+"</li>");var s=e(this).attr("disabled");if(s){var u=e(this).attr("data-opt");e(l).find('li[data-li="'+u+'"]').addClass("disabled")}var a=e(l).find("li.selected").length;var f=e(this).attr("selected");if(f&&a<1){e(o).text(e(this).text());var p=e(this).attr("data-opt");e(l).find('li[data-li="'+p+'"]').addClass("selected");c=true}})}else if(this.nodeName.toLowerCase()=="option"){var t=e(this).attr("class");if(!t)t="";var i=e(this).text();e(l).append('<li class="'+t+'">'+i+"</li>");var s=e(this).attr("disabled");if(s){var u=e(this).index();e(l).children("li").eq(u).addClass("disabled")}var a=e(l).find("li.selected").length;var f=e(this).attr("selected");if(f&&a<1){e(o).text(e(this).text());var p=e(this).index();e(l).children("li").eq(p).addClass("selected");c=true}}});e(f).append(l);if(!c){var p=0;while(e(l).find("li").eq(p).hasClass("disabled")){p++}var d=e(t).find("option").eq(p);e(o).text(e(d).text());e(l).find("li").eq(p).addClass("selected")}e(s).on("click",function(t){t.stopPropagation();if(e(this).hasClass("select-disabled"))return false;if(e(this).hasClass("optgroup"))return false;var n=e(this);e(".select-this").each(function(){if(e(this)!==n){e(this).find(".select-this-trigger-arrow").remove();e(this).find(".select-this-trigger").append('<div class="select-this-trigger-arrow"></div>')}});e(".select-this").removeClass("open-dropdown");var r=e(this).parent().find(".select-dropdown");if(e(r).is(":hidden")){e(".select-dropdown").hide();e(r).show();e(this).addClass("open-dropdown")}else{e(r).hide();e(this).removeClass("open-dropdown")}});e(l).find("li").on("click",function(t){t.stopPropagation();if(e(this).hasClass("disabled"))return false;if(e(this).hasClass("optgroup"))return false;e(this).parent().find("li").removeClass("selected");e(this).addClass("selected");e(o).text(e(this).text());e(this).parents(".select-dropdown").hide();e(this).parents(".select-wrap").find(".select-this").removeClass("open-dropdown")});e(l).find("li").hover(function(){e(this).parents("ul").addClass("hover-list")},function(){e(this).parent("ul").removeClass("hover-list")});e("html").on("click",function(){e(".select-dropdown").hide();e(".select-this").removeClass("open-dropdown")});if(n.s_height){e(t).parents(".select-wrap").find("ul").css({height:n.s_height+"px",overflowY:"scroll"})}e(t).on("refresh",function(){e(t).off().parent().before(t).remove();i.typeSelect(t)})},typeCalendar:function(t){function h(t,n){e(u).empty();var i="<tr>";var s=new Date(t,n);var o=(new Date(s.getFullYear(),s.getMonth()+1,0)).getDate();var a=(new Date(s.getFullYear(),s.getMonth(),0)).getDate();var f=(new Date(s.getFullYear(),s.getMonth(),1)).getDay();var h=(new Date(s.getFullYear(),s.getMonth(),o)).getDay();i+='<td class="prev-month">'+"<span>"+"</td>";i+='<td class="month" data-month="'+n+'" colspan="3">'+l[s.getMonth()]+"</td>";i+='<td class="year" data-year="'+t+'" colspan="2">'+t;+"</td>";i+='<td class="next-month">'+"<span>"+"</td>";i+="</tr>";for(var p=0;p<7;p++){i+='<td class="tr-week">'+c[p];+"</td>"}i+="</tr>";i+="<tr>";if(f==0){var d=a-6;for(var p=0;p<6;p++){d++;i+='<td class="prevday">'+d+"</td>"}}else{if(f==1){var d=a-7;for(var p=0;p<7;p++){d++;i+='<td class="prevday">'+d+"</td>"}i+="</tr>"}var d=a-f+1;for(var p=1;p<f;p++){d++;i+='<td class="prevday">'+d+"</td>"}}for(var p=1;p<=o;p++){var v=(new Date(t,n,p)).getDay();p==r.getDate()&&n==r.getMonth()&&t==r.getFullYear()?i+='<td class="today day">'+p+"</td>":i+='<td class="day">'+p+"</td>";if(v==0){i+="</tr>"}}if(h!=0){var m=1;for(m;m<=7-h;m++){i+='<td class="nextday">'+m+"</td>"}var g=[];g=i.split("</tr>");if(g.length<=7){i+="<tr>";for(var p=1;p<=7;p++){i+='<td class="nextday">'+m+"</td>";m++}}}else{for(var p=1;p<=7;p++)i+='<td class="nextday">'+p+"</td>";i+="</tr>"}e(u).append(i);e(u).find("tr").each(function(){e(this).find("td:eq(5), td:eq(6)").addClass("weekend")})}function p(n,i,s){if(!n)n=r.getDate();if(!i)i=r.getMonth()+1;if(!s)s=r.getFullYear();if(n<=9)n="0"+n;if(i<=9)i="0"+i;e(t).val(n+"."+i+"."+s)}function v(){var n=e(t).parents(".calendar-wrap");e(n).find(".calendar-button, .calendar").remove()}var r=new Date,i=r.getMonth(),s=r.getFullYear(),o=e('<div class="calendar-wrap"></div>'),u=e('<table class="calendar"></table>'),a=e('<span class="calendar-button"></span>'),f=e('<span class="calendar-icon"></span>');var l=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"];var c=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"];e(t).attr("readonly",true);h(s,i);p();e(document).on("click",".next-month",function(t){t.stopPropagation();var r=parseFloat(e(this).parent().find(".month").attr("data-month"));var i=parseFloat(e(this).parent().find(".year").attr("data-year"));r++;if(r>=12){r=0;i++}if(n.cal_animateSwitch){e(this).closest(u).animate({left:"100px",opacity:0},n.cal_animateSwitchSpeed,function(){h(i,r)}).animate({left:"-100px"},0).animate({left:"0",opacity:1},n.cal_animateSwitchSpeed)}else{e(this).closest(u).animate({left:0},0,function(){h(i,r)})}});e(document).on("click",".prev-month",function(t){t.stopPropagation();var r=parseFloat(e(this).parent().find(".month").attr("data-month"));var i=parseFloat(e(this).parent().find(".year").attr("data-year"));r--;if(r<=0){r=11;i--}if(n.cal_animateSwitch){e(this).closest(u).animate({left:"-100px",opacity:0},n.cal_animateSwitchSpeed,function(){h(i,r)}).animate({left:"100px"},0).animate({left:"0",opacity:1},n.cal_animateSwitchSpeed)}else{e(this).closest(u).animate({left:0},0,function(){h(i,r)})}});if(e(t).parents(".calendar-wrap").length<1){e(t).wrap(o);e(t).after(a,u);e(a).append(f)}else{v();e(t).after(a,u);e(a).append(f)}var d=e(t).attr("disabled");if(d){e(t).parent(".calendar-wrap").addClass("calendar-disabled")}e(a).on("click",function(t){if(e(this).parents(".calendar-wrap").hasClass("calendar-disabled"))return false;t.stopPropagation();e(".calendar").stop(1).fadeOut(n.cal_animateSpeed);e(this).next(".calendar").stop(1).fadeToggle(n.cal_animateSpeed)});e(u).on("click",".day",function(){e(this).closest(".calendar").find("td").removeClass("select-day");e(this).addClass("select-day");var t=e(this).closest(".calendar").find(".month").text();var n=e(this).closest(".calendar").find(".year").text();var r;for(var i=0;i<l.length;i++){if(l[i]==t){r=i+1}}p(e(this).text(),r,n)});e(document).on("click",function(t){if(e(t.target).closest(".calendar").length)return;e(u).fadeOut(n.cal_animateSpeed);t.stopPropagation()})},typeSearch:function(t){var r=[],s=0,o='<ul class="result-list">',u=e('<div class="seach-wrap">'),a=e('<div class="seach-bg">'),f=e('<input type="submit" class="seach-icon">'),l="#"+e(t).attr("data-list");e(t).wrap(u);e(t).after(o,e(l));e(t).wrap(a);e(t).before(f);e(l).css("display","none");var o=e(t).closest(".seach-wrap").find(".result-list");e(l).find("li").each(function(){r.push(e(this).text());e(o).append("<li>"+"<span>"+e(this).text()+"</span>"+"</li>")});e(t).keyup(function(i){s=e(this).val().length;var u=e(o).find("li").data("li-height");if(i.which!==38&&i.which!==40){var a=e(this).val().toLowerCase();if(!a){e(o).stop().fadeIn(200);return false}for(var f=0;f<r.length;f++){var l=r[f].toLowerCase().substr(0,s);var c=a.substr(0,s);if(l==c){if(e('li:contains("'+r[f]+'")').length==0){console.log("11");e("<li>"+"<span>"+r[f]+"</span>"+"</li>").appendTo(o)}}else{e('li:contains("'+r[f]+'")').remove()}}e(".no-result").remove();if(e(o).find("li").length==0){e('<li class="no-result">'+"<span>"+"Совпадений не найдено."+"</span>"+"</li>").appendTo(o)}}else if(e(o).is(":visible")){if(e(o).find("li.no-result").length!==0)return false;var h=e(o).find("li.selected");var p=e(o).find("li").length;if(i.which==40){if(h.length==0){e(o).find("li").eq(0).addClass("selected")}else{e(h).next().addClass("selected");e(h).removeClass("selected");if(!e(h).next().length){e(o).find("li").eq(0).addClass("selected")}}e(o).scrollTop(e(".result-list").scrollTop()+e(".result-list").find("li").filter(".selected").position().top)}else if(i.which==38){e(h).prev().addClass("selected");e(h).removeClass("selected");if(!e(h).prev().length){e(o).find("li").eq(p-1).addClass("selected")}e(o).scrollTop(e(".result-list").scrollTop()+e(".result-list").find("li").filter(".selected").position().top)}var d=e(o).find("li.selected").text();e(t).val(d)}e(o).css("max-height",n.se_height);s?e(o).fadeIn(n.se_animateToogleSpeed):e(o).fadeOut(n.se_animateToogleSpeed)});e(document).on("click",".result-list li",function(){if(e(this).hasClass("no-result"))return false;var t=e(this).text();e(this).parents(".seach-wrap").find("li").removeClass("selected");e(this).addClass("selected");e(this).parents(".seach-wrap").find('input[type="usfe-search"]').val(t)});e("body").on("click",function(){e(o).fadeOut(n.se_animateToogleSpeed)});var c=e(t).parent("div").css("backgroundColor");var h=e(t).css("color");if(n.se_animateEffect){e(t).focus(function(){e(this).parent(".seach-bg").animate({backgroundColor:n.se_backgroundcolor,color:n.se_color},n.se_animateSpeed);e(this).animate({color:n.se_color},n.se_animateSpeed);e(this).next(".seach-icon").css({backgroundPosition:"0 -23px"})});e(t).focusout(function(){e(this).parent(".seach-bg").animate({backgroundColor:c,color:h},n.se_animateSpeed);e(this).animate({color:h},n.te_animateSpeed);e(this).next(".seach-icon").css({backgroundPosition:"0 0"})})}e(t).on("refresh",function(){e(t).off().parent().before(t).remove();i.typeSearch(t)})}};return this.each(function(){function n(t){var n=e(t).attr("type");switch(n){case"file":i.typeFile(t);break;case"text":case"password":case"email":i.typeText(t);break;case"usfe-number":i.typeNumber(t);break;case"submit":case"button":case"reset":i.typeButton(t);break;case"textarea":i.typeTextarea(t);break;case"radio":i.typeRadio(t);break;case"checkbox":i.typeCheckbox(t);break;case"select":i.typeSelect(t);break;case"usfe-calendar":i.typeCalendar(t);break;case"usfe-search":i.typeSearch(t);break;default:console.log("Ошибка! Элемент не может быть обработан:");console.log(t)}}var t;if(this.nodeName.toLowerCase()=="form"){e(this).find("input, button, textarea, select").each(function(){if(this.nodeName.toLowerCase()=="textarea")e(this).attr("type","textarea");if(this.nodeName.toLowerCase()=="select")e(this).attr("type","select");t=this;n(t)})}else{if(this.nodeName.toLowerCase()=="textarea"){e(this).attr("type","textarea")}if(this.nodeName.toLowerCase()=="select"){e(this).attr("type","select")}n(this)}})}})(jQuery)